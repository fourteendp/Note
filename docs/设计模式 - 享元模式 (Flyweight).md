---
title: 享元模式 (Flyweight)
uid: 20240123112807184
aliases: []
categories: []
tags:
  - 计算机/设计模式/GoF设计模式/结构型模式
archive: false
draft: false
todo: false
createTime: 2023-05-07 22:01:31
updateTime: 2024-08-02 13:59:50
---

- 定义：运用共享技术有效地支持大量细粒度的对象
- 解释：享元模式是一种结构型设计模式，运用共享技术有效地支持大量细粒度的对象
- 优点：大大减少对象的创建，降低系统的内存，使效率提高
- 缺点：提高了系统的复杂性；为了节省内存，共享了内部状态，分离出了外部状态，而读取外部状态使得运行时
  间变长
- 适用场景：系统中有大量对象；这些对象消耗大量内存；这些对象的状态大部分可以外部化；这些对象可以按照
  内部状态分成较少的大类；系统不依赖于这些对象身份，这些对象是不可分辨的
- 模式结构：
  - 抽象享元（Flyweight）角色：是所有的具体享元类的超类，为这些类规定出需要实现的公共接口
  - 具体享元（Concrete Flyweight）角色：实现抽象享元角色所规定的接口
  - 享元工厂（Flyweight Factory）角色：本角色负责创建和管理享元角色。本角色必须保证享元对象可以被系
    统适当地共享。当一个客户端对象调用一个享元对象的时候，享元工厂角色会检查系统中是否已经有一个符合
    要求的享元对象。如果已经有了，享元工厂角色就应当提供这个已有的享元对象；如果系统中没有一个适当的
    享元对象的话，享元工厂角色就应当创建一个合适的享元对象
  - 外部状态（Unshared Concrete Flyweight）角色：指那些不需要共享的外部状态。由于享元对象可以被共
    享，而外部状态不能被共享，所以必须将其存储外部。当调用一个享元对象的操作时，传入一个外部状态
  - 内部状态（Shared Concrete Flyweight）角色：指那些可以共享的内部状态。内部状态可以被一些对象共
    享。内部状态存储于享元对象内部并且不会随环境的改变而改变
  - 客户（Client）角色：本角色需要维护一个对所有享元对象的引用。当一个客户端对象调用一个享元对象的时
    候，必须传入一个外部状态
