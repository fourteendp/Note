---
title: 数据库 - 为什么实际开发中不使用外键
uid: 1722908582099
aliases: []
categories: 
tags: []
archive: false
draft: false
todo: false
createTime: 2024-08-06 09:43:02
updateTime: 2024-09-12 08:13:17
---

在实际开发中，外键的使用与否是一个需要权衡的问题。外键可以确保数据库中数据的完整性和一致性，但它们也可能带来一些缺点，特别是在高并发和分布式系统环境中。以下是一些不使用外键的原因：

1. **外键约束在修改或删除数据时可能会造成不便**，因为每次操作都需要考虑外键约束，这可能限制了灵活性 。
2. **外键可能会引起表级锁和并发问题**，当主表写入时，相关的从表可能会被锁定，影响并发性能 。
3. **级联删除问题**，如果主表中的记录被删除，相关的从表记录也会被删除，这可能导致数据丢失或不可预见的数据变动 。
4. **高耦合和迁移困难**，当需要对主表进行分表或数据迁移时，外键的存在可能会使得这一过程变得复杂 。
5. **性能问题**，外键的存在可能需要服务器在更改数据时进行额外的检查，这可能会影响性能，尤其是在大表中 。
6. **外键可能导致意外的锁等待或死锁**，尤其是在高并发的环境下，这会使得问题难以定位 。
7. **互联网大厂通常禁用外键**，因为在分布式项目中，为了提高数据库的并发性能，通常在业务层面实现数据一致性，而不是依赖数据库的外键约束 。
8. **外键可能需要额外的索引**，这会增加数据表的存储空间，尤其是当主键存储空间较大时 。

然而，在某些情况下，外键的使用是合适的，比如在并发量不高、表数据量不大、对数据一致性要求较高的单体式项目中 。最终，是否使用外键应该根据具体的应用场景和业务需求来决定。

## 使用外键的业务场景

1. **数据一致性要求较高**，比如金融、医疗等领域的项目，对数据的完整性和一致性要求较高 。
2. **数据量较小**，外键的检查和维护对性能影响较小 。
3. **数据表之间的关联性较强**，外键可以帮助维护表之间的关系，减少数据冗余和错误 。
4. **数据表之间的关系较为简单**，外键的维护和管理相对容易 。
5. **不需要频繁修改数据**，外键的存在可能会限制数据的修改和删除操作 。
